{% extends "base.html" %}

{% load staticfiles %}

{% block css %}

{{ block.super }}
  <link rel="stylesheet" type="text/css" href="{% static 'css/modal.css' %}">

{% endblock css %}

{% block js %}

{{ block.super }}
  <script type="text/javascript" src="{% static 'js/persons.js' %}"></script>
  <script type="text/javascript">
    var personListUrl = "{% url 'person-list' %}";
  </script>

{% endblock js %}


{% block content %}

<div class="form-group">
  <label class="control-label" for="focusedInput">&nbsp;</label>
  <div class="input-group">
    <input type="text" class="form-control" id="person-input" />
    <span class="input-group-btn">
      <button class="btn btn-default" id="search-submit-btn" type="button">Искать</button>
    </span>
  </div>
</div>

<span id="indicator" style="display:none;"><img src="http://upload.wikimedia.org/wikipedia/commons/d/de/Ajax-loader.gif"/></span>
<div id="results"></div>

<h2>{{ object.full_name }}</h2>

{{ form }}

<div class="dossier">
  {% if "-" in object.living_years %}
    Годы жизни: {{ object.living_years }}
  {% else %}
    Дата рождения: {{ object.living_years }}
  {% endif %}
</div>
<div class="story">{{ object.story | safe }}</div>

{% if object.seasons.all %}
<h4>Сезоны</h4>
<table class="table table-striped table-hover" id="person-seasons">
<thead>
  <tr>
    <th>Год</th>
    <th>Амплуа</th>
    <th>Турнир</th>
    <th>Команда</th>
    <th>Комментарии</th>
  </tr>
</thead>
<tbody>
{% for season in object.seasons.all %}
  <tr class="document-row">
    <td> {{ season.year }} </td>
    <td> {{ season.role_verbose|default:"" }} </td>
    <td> 
    {% if season.tournament %}
      <a class="link" 
         href="#">
         {{ season.tournament }}
      </a>
    {% else %}
      -
    {% endif %}
    </td>
    <td>
    {% if season.team %}
      {{ season.team }}
    {% else %}
      -
    {% endif %}
    </td>
    <td> {{ season.story | markdown }} </td>
  </tr>
{% endfor %}
</tbody></table>
{% endif %}

{% if object.documents %}
<h4>Документы</h4>
<table class="table table-striped table-hover" id="documents-table">
  <thead>
    <tr>
      <th>Заголовок</th>
      <th>Описание</th>
      <th>Месяц/Год</th>
      <th>Ссылка</th>
    </tr>
  </thead>
  <tbody>
    
  {% for doc in object.documents %}
  <tr class="document-row">
    <td> {{ doc.title }} </td>
    <td> {{ doc.description }} </td>
    <td> {{ doc.date }} </td>
    <td> {% if doc.is_image %}
      <a class="dropbox-link" 
         href="{{ doc.dropbox_path }}">
         <img src="{{ doc.dropbox_thumb }}"/>
      </a>
    {% else %}
      <a class="dropbox-link" 
         href="{{ doc.dropbox_path }}">
         Нет превью
      </a>
    {% endif %}
    </td>
  </tr>
  {% endfor %}
  </tbody>
</table>

{% endif %}

{% include '_modal.html' %}

{% endblock content %}
